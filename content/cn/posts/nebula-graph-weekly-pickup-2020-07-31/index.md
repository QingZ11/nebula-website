---
title: "Pick of the Week'20 | ç¬¬ 31 å‘¨çœ‹ç‚¹--å›¾éå†æ”¯æŒ int ç±»å‹ä¼ å…¥æŸ¥è¯¢"
date: 2020-07-31
description: "åœ¨æœ¬æ¬¡çš„æ¯å‘¨çœ‹ç‚¹ä¸­ä½ å°†äº†è§£æœ€è¿‘çš„å›¾éå†åŠŸèƒ½çš„ä½¿ç”¨ï¼ŒåŠ Nebula Graph ä¸­ VIDã€TAG ç­‰æ¦‚å¿µã€‚"
tags: ["ç¤¾åŒº","äº§å“åŠ¨æ€"]
author: "ä¹”æ²», æ¸…è’¸"
---

![æ¯å‘¨çœ‹ç‚¹](https://www-cdn.nebula-graph.com.cn/nebula-blog/PotW.png)

> æ¯å‘¨äº”Â Nebula ä¸ºä½ æ’­æŠ¥æ¯å‘¨çœ‹ç‚¹ï¼Œæ¯å‘¨çœ‹ç‚¹ç”±å›ºå®šæ¨¡å—ï¼šç‰¹æ€§è®²è§£ã€Nebula äº§å“åŠ¨æ€ã€ç¤¾åŒºé—®ç­”ã€æ¨èé˜…è¯»ï¼Œå’Œéšæœºæ¨¡å—ï¼šæœ¬å‘¨å¤§äº‹ä»¶æ„æˆã€‚

å³å°†é€èµ°çš„æ˜¯ 2020 å¹´ç¬¬ 31 ä¸ªå·¥ä½œå‘¨çš„å‘¨äº” ğŸŒ æ¥å’Œ Nebula ä¸€å—å›é¡¾ä¸‹æœ¬å‘¨å›¾æ•°æ®åº“å’Œ Nebula æœ‰ä»€ä¹ˆæ–°çœ‹ç‚¹~~

## ç‰¹æ€§è®²è§£

- [å›¾éå†æ”¯æŒ int ç±»å‹ä¼ å…¥æŸ¥è¯¢](https://github.com/vesoft-inc/nebula/pull/2225)

æœ¬å‘¨å›¾éå†ï¼ˆGOï¼‰è¿æ¥æ–°åŠŸèƒ½â€”â€”æ”¯æŒå°† int ç±»å‹æ•°æ®ä¼ å…¥ GO è¯­å¥ä¸­æŸ¥è¯¢ã€‚è¿™ä¸°å¯Œäº†å›¾éå†çš„åº”ç”¨åœºæ™¯ï¼Œé€šè¿‡ä¼ å…¥ int ç±»å‹æ•°æ®è¿›è¡Œå›¾éå†ç®€åŒ–äº†æŸ¥è¯¢æ“ä½œä¹Ÿç›´æ¥çš„æå‡äº†æŸ¥è¯¢æ€§èƒ½ã€‚

ä¾‹å¦‚ï¼šä¸ºä»£è¡¨ç”¨æˆ· ID çš„ç‚¹åˆ›å»º timestamp ç±»å‹å±æ€§ï¼Œå¹¶åˆ›å»ºä»¥ç›¸åŒ timestamp ä¸º vid çš„ç‚¹æ¥è®°å½•ç”¨æˆ·æ“ä½œã€‚æ­¤æ—¶é€šè¿‡ `FETCH`Â ã€ `LOOKUP`Â ç­‰è¯­å¥æŸ¥è¯¢å‡ºä¸€å®šèŒƒå›´çš„ç‚¹ï¼Œå°†æŸ¥è¯¢åˆ°çš„ç‚¹æ‰€åŒ…å«çš„ timestamp å±æ€§ä½œä¸º ID ä¼ å…¥ GO è¯­å¥å³å¯æŸ¥è¯¢åˆ°è¯¥æ—¶é—´æˆ³æ‰€å¯¹åº”çš„æ“ä½œè®°å½•ã€‚

æ­¤å¤„æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå°åœºæ™¯æ¥å±•ç¤ºæ–°åŠŸèƒ½æ‰€å¸¦æ¥çš„ä¾¿åˆ©æ€§ï¼Œé¦–å…ˆåˆ›å»º tag t4 ç”¨äºæè¿°ç”¨æˆ·å§“åå’Œæ“ä½œæ—¶é—´ï¼Œåˆ›å»º tag t5 ç”¨äºæè¿°ç”¨æˆ·æ“ä½œï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ t4 ä¸­çš„æ—¶é—´æˆ³ä½œä¸º tag t5 å…³è”çš„ç‚¹ IDã€‚

ç”¨ Nebula studio å›¾æ¢ç´¢åŠŸèƒ½å±•ç¤ºå…³ç³»å¦‚ä¸‹ï¼š

![æ¯å‘¨çœ‹ç‚¹](https://www-cdn.nebula-graph.com.cn/nebula-blog/PotW203101.png)

- create tag t4(user_name string, action_time timestamp);
- create tag t5(user_action string);

åˆ›å»ºè¾¹çš„ schemaï¼Œç”¨äºæè¿° t4ï¼ˆç”¨æˆ·ï¼‰ä¸ t5ï¼ˆç”¨æˆ·æ“ä½œï¼‰çš„å…³ç³»ä¸ºç©æ¸¸æˆã€‚

- create edge play_games ();

![æ¯å‘¨çœ‹ç‚¹](https://www-cdn.nebula-graph.com.cn/nebula-blog/PotW203102.png)

æ­¤æ—¶æ’å…¥ç‚¹ 730 å…³è” tag t4 ç”¨äºæè¿°ç”¨æˆ·å§“åå’Œæ“ä½œæ—¶é—´

- insert vertex t4(user_name, action_time) values 730:("xiaowang",1596103557);

æ’å…¥ç‚¹ 1596103557 ç”¨äºè¡¨ç¤ºåœ¨æ­¤æ—¶é—´æˆ³æ—¶ç”¨æˆ·çš„è¡Œä¸ºæ˜¯â€œplay smart phone gamesâ€ã€‚

- insert vertex t5(user_action) values 1596103557:("play smart phone games");

æ’å…¥ä¸€æ¡è¾¹ç”¨äºå…³è”ä¸¤ä¸ªç‚¹çš„å…³ç³»

- insert edge play_games() values 730->1596103557:();

![æ¯å‘¨çœ‹ç‚¹](https://www-cdn.nebula-graph.com.cn/nebula-blog/PotW203103.png)

ç”±äº GO è¯­å¥æ–°åŠŸèƒ½çš„åŠ å…¥ï¼Œæˆ‘ä»¬æ­¤æ—¶å¯ä»¥é€šè¿‡ä¸€æ¡ query è¿›è¡ŒæŸ¥è¯¢ã€‚

è¿™æ¡ query è¡¨ç¤ºé€šè¿‡æŸ¥è¯¢ç‚¹ 730 çš„æ‰€æœ‰ tagï¼Œä½¿æŸ¥è¯¢åˆ°çš„å±æ€§ t4.action_time ä½œä¸ºå˜é‡ timeidã€‚é€šè¿‡ pipe ä¼ å…¥ GO è¯­å¥åœ¨è¾¹ play_games ä¸Šåšåå‘æŸ¥è¯¢ï¼Œå°†è¿™æ¡è¾¹ä¸Šçš„èµ·å§‹ç‚¹å±æ€§ t5.user_action ä½œä¸º players_action æ ‡é¢˜è¿›è¡Œå±•ç¤ºã€‚

![æ¯å‘¨çœ‹ç‚¹](https://www-cdn.nebula-graph.com.cn/nebula-blog/PotW203104.png)

## ç¤¾åŒºé—®ç­”

Pick of the Week æ¯å‘¨ä¼šä»å®˜æ–¹è®ºå›ã€å¾®åšã€çŸ¥ä¹ã€å¾®ä¿¡ç¾¤ã€å¾®ä¿¡å…¬ä¼—å·åŠ CSDN ç­‰æ¸ é“ç²¾é€‰é—®é¢˜åŒä½ åˆ†äº«ã€‚

æœ¬å‘¨åˆ†äº«çš„ä¸»é¢˜æ˜¯ã€Nebula Graph ä¸­çš„ VIDã€TAGã€‘ï¼Œç”±ç¤¾åŒºç”¨æˆ· tmac æå‡ºï¼ŒNebula Graph å®˜æ–¹è§£ç­”ã€‚

> tmac æé—®ï¼šVID æ˜¯åœ¨æ•´ä¸ªå›¾ç©ºé—´ä¸­å”¯ä¸€ï¼Œè¿˜æ˜¯åœ¨ä¸€ç±» TAG ä¸Šå”¯ä¸€å‘¢ï¼Ÿedge vid1->vid2 æ˜¯ vid1 å…³è”çš„æ‰€æœ‰tagï¼ˆå¯èƒ½æœ‰å¤šä¸ªï¼‰éƒ½ä¼šæŒ‡å‘ vid2 å…³è”çš„æ‰€æœ‰ tag æ˜¯å—ï¼Ÿ

**Nebula**ï¼šVid æ˜¯ Nebula Graph ä¸­ä¸€ä¸ªç‚¹çš„å”¯ä¸€æ ‡ç¤ºï¼ŒTag æ˜¯å¯¹ä¸€ä¸ªç‚¹æè¿°çš„å±æ€§é›†åˆï¼Œç‚¹å’Œç‚¹ä¹‹é—´çš„å…³ç³»é€šè¿‡ Edgeï¼ˆè¾¹ï¼‰ç¡®å®šã€‚åŒæ—¶å¦‚ Tag ä¸€æ ·ï¼Œè¾¹ä¸Šä¹Ÿå¯ä»¥é™„åŠ å±æ€§é›†åˆï¼Œå±æ€§é›†åˆç§°ä½œ Edgeã€‚

ä¸¾ä¸ªä¾‹å­æ›´å®¹æ˜“ç†è§£ï¼Œä¾‹å¦‚æœ‰ä¸€ä¸ªäººï¼Œæˆ‘ä»¬æŠŠä»–å½“ä½œä¸€ä¸ªç‚¹ï¼Œé‚£è¿™ä¸ª Vid å°±æ˜¯è¿™ä¸ªäººçš„å”¯ä¸€æ ‡ç¤ºï¼Œä¾‹å¦‚è¿™ä¸ªäººæœ‰ä¸¤ä¸ªèº«ä»½ï¼šâ€œå­¦ç”Ÿâ€ å’Œ â€œç²‰ä¸â€ ã€‚é‚£ä¹ˆç›¸å¯¹åº”çš„ Tag ä¹Ÿæœ‰ä¸¤ä¸ªï¼š

- create tag å­¦ç”Ÿï¼ˆç³»ï¼Œç­çº§ï¼Œç¤¾å›¢ï¼‰
- create tag ç²‰ä¸ï¼ˆå…³æ³¨å¯¹è±¡ï¼Œå…³æ³¨å¼€å§‹æ—¶é—´ï¼Œåª’ä»‹ç±»åˆ«ï¼‰

ç”±ä¸Šè¾¹çš„ä¾‹å­å¯çŸ¥ï¼Œä¸€ä¸ª Vid å¯ä»¥å…³è”å¤šä¸ª Tagï¼Œä¾‹å¦‚

- Tom(Vid1)_å­¦ç”Ÿ(TagId1) : è®¡ç®—æœºç³»_1ç­_ ç¯®çƒ
- Tom(Vid1)_ç²‰ä¸(TagId2) : è€ç½—_2020-1_Bç«™

å†æ¥è§£é‡Šä¸€ä¸‹ç‚¹å’Œç‚¹ä¹‹é—´çš„å…³ç³»ï¼Œç‚¹å’Œç‚¹ä¹‹é—´çš„å…³ç³»ç”¨ Edge æ¥æè¿°ï¼Œä¾‹å¦‚æœ‰ä¸¤ä¸ªç‚¹ ï¼š

- Tom(Vid1)_å­¦ç”Ÿ(TagId1) : è®¡ç®—æœºç³»_1ç­_ ç¯®çƒ
- Jack(Vid2)_å­¦ç”Ÿ(TagId1) : è´¢ç»ç³»_2ç­_æŸ”é“
- Tom(Vid1)_ç²‰ä¸(TagId2) : è€ç½—_2020-1_Bç«™
- Jack(Vid2)_ç²‰ä¸(TagId2) : è€ç½—_2021-1_Bç«™

è¿™ä¸¤ä¸ªäººå¯èƒ½æ˜¯è€ä¹¡ï¼Œä¹Ÿå¯èƒ½æ˜¯åŒä¸€ä¸ªäººçš„ç²‰ä¸ï¼Œé‚£å»ºç«‹ä»–ä»¬çš„å…³ç³»å¦‚ä¸‹

- create Edge å…³ç³» (è€ä¹¡)
- create Edge å…³æ³¨æ¨èï¼ˆå…³æ³¨å¯¹è±¡ï¼‰

å…³ç³»å¦‚ä¸‹ï¼š

- Tom(Vid1) -> è€ä¹¡(Edge å…³ç³»)-> Jack(Vid2)
- Jack(Vid2) -> æ¨èè€ç½—ï¼ˆEdge å…³æ³¨æ¨èï¼‰-> Tom(Vid1)


ç”±ä¾‹å­å¯çŸ¥ï¼ŒVid1 æŒ‡å‘ Vid2 å¹¶ä¸æ˜¯ç”± Tag å†³å®šï¼Œè€Œæ˜¯ç”± Edge å†³å®šã€‚æ‰€ä»¥å…³äºâ€œvid1 å…³è”çš„æ‰€æœ‰ tagï¼ˆå¯èƒ½æœ‰å¤šä¸ªï¼‰éƒ½ä¼šæŒ‡å‘ vid2 å…³è”çš„æ‰€æœ‰ tag æ˜¯å—â€è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ç†è§£ä¸ºç‚¹é€šè¿‡ Edge æœç´¢å…¶æœ‰å…³ç³»çš„ç›®æ ‡ç‚¹ï¼Œå¯»æ‰¾åˆ°ç›®æ ‡é¡¶ç‚¹åï¼Œå¯ä»¥é€šè¿‡ç›®æ ‡é¡¶ç‚¹çš„ Vid å†è¿›ä¸€æ­¥æŸ¥çœ‹å…¶ç›¸å…³çš„ Tagã€‚

## æ¨èé˜…è¯»

- å¾€æœŸ Pick of the Week
   - [Pick of the Week'20 | ç¬¬ 30 å‘¨çœ‹ç‚¹--å±æ€§æŸ¥è¯¢è¿æ¥æ–°åŠŸèƒ½](https://nebula-graph.com.cn/posts/nebula-graph-weekly-pickup-2020-07-24/)
   - [Pick of the Week'20 | ç¬¬ 29 å‘¨çœ‹ç‚¹-- nGQL vs SQL](https://nebula-graph.com.cn/posts/nebula-graph-weekly-pickup-2020-07-17/)

æœ¬æœŸ Pick of the Week å°±æ­¤å®Œæ¯•ï¼Œå–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Ÿæ¥æ¥æ¥ï¼Œç»™æˆ‘ä»¬çš„ [GitHub](https://github.com/vesoft-inc/nebula) ç‚¹ä¸ª star è¡¨é¼“åŠ±å•¦~~ ğŸ™‡â€â™‚ï¸ğŸ™‡â€â™€ï¸ [æ‰‹åŠ¨è·ªè°¢]

äº¤æµå›¾æ•°æ®åº“æŠ€æœ¯ï¼Ÿäº¤ä¸ªæœ‹å‹ï¼ŒNebula Graph å®˜æ–¹å°åŠ©æ‰‹å¾®ä¿¡ï¼š[NebulaGraphbot](https://www-cdn.nebula-graph.com.cn/nebula-blog/nbot.png) æ‹‰ä½ è¿›äº¤æµç¾¤~~

![å…³æ³¨å…¬ä¼—å·](https://www-cdn.nebula-graph.com.cn/nebula-blog/WeChatOffical.png)
